<!DOCTYPE html>
<html lang="pt-br">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Comparador de Carteiras â€” JACOBINA</title>
Â  Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
Â  Â  <style>
Â  Â  Â  Â  @import url('https://fonts.googleapis.com/css2?family=DM+Mono:wght@400;500&family=Syne:wght@700;800&family=DM+Sans:wght@300;400;500&display=swap');

Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --bg: #0d0f14; --surface: #161922; --border: #252a36;
Â  Â  Â  Â  Â  Â  --accent: #f5a623; --accent2: #3ecf8e; --danger: #ff5c5c;
Â  Â  Â  Â  Â  Â  --muted: #4a5168; --text: #e8eaf0; --text-dim: #7c839a;
Â  Â  Â  Â  Â  Â  --added: rgba(62, 207, 142, 0.08); --removed: rgba(255, 92, 92, 0.08);
Â  Â  Â  Â  Â  Â  --changed: rgba(245, 166, 35, 0.08); --added-border: #3ecf8e;
Â  Â  Â  Â  Â  Â  --removed-border: #ff5c5c; --changed-border: #f5a623;
Â  Â  Â  Â  }

Â  Â  Â  Â  * { box-sizing: border-box; margin: 0; padding: 0; }
Â  Â  Â  Â  body { background: var(--bg); color: var(--text); font-family: 'DM Sans', sans-serif; font-size: 14px; min-height: 100vh; line-height: 1.5; }

Â  Â  Â  Â  header { padding: 20px 40px; border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 16px; background: var(--surface); }
Â  Â  Â  Â  .logo-mark { width: 38px; height: 38px; background: var(--accent); display: grid; place-items: center; font-family: 'Syne', sans-serif; font-weight: 800; font-size: 18px; color: #000; border-radius: 4px; }
Â  Â  Â  Â  header h1 { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 18px; letter-spacing: -0.5px; }
Â  Â  Â  Â  header span { color: var(--text-dim); font-size: 12px; font-family: 'DM Mono', monospace; margin-left: 4px; }

Â  Â  Â  Â  .main { padding: 32px 40px; max-width: 1600px; margin: 0 auto; }

Â  Â  Â  Â  .upload-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 24px; }
Â  Â  Â  Â  .upload-card { background: var(--surface); border: 1.5px dashed var(--border); border-radius: 10px; padding: 30px; text-align: center; cursor: pointer; transition: 0.2s; position: relative; }
Â  Â  Â  Â  .upload-card:hover { border-color: var(--accent); background: rgba(245, 166, 35, 0.02); }
Â  Â  Â  Â  .upload-card.loaded { border-style: solid; border-color: var(--accent2); background: rgba(62, 207, 142, 0.02); }
Â  Â  Â  Â  .upload-card input { position: absolute; inset: 0; opacity: 0; cursor: pointer; }
Â  Â  Â  Â  .upload-label { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 11px; letter-spacing: 2px; text-transform: uppercase; color: var(--text-dim); margin-bottom: 8px; display: flex; align-items: center; justify-content: center; gap: 8px; }
Â  Â  Â  Â  .upload-name { font-family: 'DM Mono', monospace; font-size: 12px; color: var(--accent2); margin-top: 8px; word-break: break-all; }

Â  Â  Â  Â  .controls { display: flex; align-items: center; gap: 16px; margin-bottom: 28px; background: var(--surface); padding: 20px; border-radius: 10px; border: 1px solid var(--border); }
Â  Â  Â  Â  select { background: var(--bg); border: 1px solid var(--border); color: var(--text); padding: 8px 12px; border-radius: 6px; cursor: pointer; }
Â  Â  Â  Â  .btn-compare { background: var(--accent); color: #000; border: none; padding: 12px 28px; border-radius: 6px; font-family: 'Syne', sans-serif; font-weight: 700; cursor: pointer; transition: 0.2s; margin-left: auto; }
Â  Â  Â  Â  .btn-compare:disabled { opacity: 0.3; cursor: not-allowed; }

Â  Â  Â  Â  .summary-row { display: flex; gap: 16px; margin-bottom: 24px; }
Â  Â  Â  Â  .stat-card { background: var(--surface); border: 1px solid var(--border); border-radius: 8px; padding: 16px 24px; flex: 1; }
Â  Â  Â  Â  .stat-val { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 32px; margin-bottom: 4px; }
Â  Â  Â  Â  .stat-label { font-size: 11px; color: var(--text-dim); text-transform: uppercase; font-family: 'DM Mono', monospace; }

Â  Â  Â  Â  .filter-tabs { display: flex; gap: 8px; margin-bottom: 20px; border-bottom: 1px solid var(--border); }
Â  Â  Â  Â  .tab-btn { background: none; border: none; color: var(--text-dim); padding: 12px 20px; cursor: pointer; border-bottom: 2px solid transparent; transition: 0.2s; }
Â  Â  Â  Â  .tab-btn.active { color: var(--accent); border-bottom-color: var(--accent); }

Â  Â  Â  Â  .table-wrap { overflow-x: auto; border: 1px solid var(--border); border-radius: 10px; background: var(--surface); }
Â  Â  Â  Â  table { width: 100%; border-collapse: collapse; font-size: 13px; text-align: left; }
Â  Â  Â  Â  th { padding: 14px; background: rgba(0,0,0,0.2); color: var(--text-dim); font-family: 'DM Mono', monospace; text-transform: uppercase; font-size: 11px; border-bottom: 1px solid var(--border); }
Â  Â  Â  Â  td { padding: 12px 14px; border-bottom: 1px solid rgba(255,255,255,0.03); }
Â  Â  Â  Â  
Â  Â  Â  Â  .row-added { border-left: 4px solid var(--accent2); background: var(--added); }
Â  Â  Â  Â  .row-removed { border-left: 4px solid var(--danger); background: var(--removed); }
Â  Â  Â  Â  .row-changed { border-left: 4px solid var(--accent); background: var(--changed); }

Â  Â  Â  Â  .old-val { color: var(--danger); text-decoration: line-through; font-size: 11px; display: block; }
Â  Â  Â  Â  .new-val { color: var(--accent2); font-weight: 500; display: block; }
Â  Â  Â  Â  
Â  Â  Â  Â  .badge { padding: 2px 8px; border-radius: 4px; font-size: 10px; font-family: 'DM Mono', monospace; text-transform: uppercase; }
Â  Â  Â  Â  .badge-added { background: rgba(62, 207, 142, 0.2); color: var(--accent2); }
Â  Â  Â  Â  .badge-removed { background: rgba(255, 92, 92, 0.2); color: var(--danger); }
Â  Â  Â  Â  .badge-changed { background: rgba(245, 166, 35, 0.2); color: var(--accent); }

Â  Â  Â  Â  #col-chips { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
Â  Â  Â  Â  .chip { padding: 4px 12px; background: var(--bg); border: 1px solid var(--border); border-radius: 20px; font-size: 11px; cursor: pointer; transition: 0.2s; color: var(--text-dim); }
Â  Â  Â  Â  .chip.active { border-color: var(--accent); color: var(--accent); background: rgba(245, 166, 35, 0.1); }
Â  Â  Â  Â  
Â  Â  Â  Â  #loading { display: none; padding: 40px; text-align: center; font-family: 'DM Mono', monospace; color: var(--accent); }
Â  Â  </style>
</head>
<body>

<header>
Â  Â  <div class="logo-mark">J</div>
Â  Â  <h1>Comparador de Carteiras <span>// JACOBINA</span></h1>
</header>

<div class="main">
Â  Â  <div class="upload-grid">
Â  Â  Â  Â  <div class="upload-card" id="card-a" ondragover="event.preventDefault()" ondrop="handleDrop(event, 'a')">
Â  Â  Â  Â  Â  Â  <input type="file" onchange="handleFile(event, 'a')" accept=".xlsx, .xls, .csv">
Â  Â  Â  Â  Â  Â  <div class="upload-label">ðŸ“… Arquivo Anterior (Base)</div>
Â  Â  Â  Â  Â  Â  <div class="upload-name" id="name-a">Arraste ou clique para selecionar</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="upload-card" id="card-b" ondragover="event.preventDefault()" ondrop="handleDrop(event, 'b')">
Â  Â  Â  Â  Â  Â  <input type="file" onchange="handleFile(event, 'b')" accept=".xlsx, .xls, .csv">
Â  Â  Â  Â  Â  Â  <div class="upload-label">ðŸ“… Arquivo Novo (ComparaÃ§Ã£o)</div>
Â  Â  Â  Â  Â  Â  <div class="upload-name" id="name-b">Arraste ou clique para selecionar</div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="controls">
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  <label class="stat-label">Aba Anterior:</label><br>
Â  Â  Â  Â  Â  Â  <select id="sheet-a" onchange="preloadCols()"></select>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  <label class="stat-label">Aba Nova:</label><br>
Â  Â  Â  Â  Â  Â  <select id="sheet-b" onchange="preloadCols()"></select>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  <label class="stat-label">Coluna Chave (ID):</label><br>
Â  Â  Â  Â  Â  Â  <select id="key-col"></select>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <button class="btn-compare" id="btn-compare" onclick="compare()" disabled>Executar ComparaÃ§Ã£o</button>
Â  Â  </div>

Â  Â  <div id="col-section" style="display:none; margin-bottom: 24px;">
Â  Â  Â  Â  <p class="stat-label">Colunas para Monitorar AlteraÃ§Ãµes:</p>
Â  Â  Â  Â  <div id="col-chips"></div>
Â  Â  </div>

Â  Â  <div id="loading">Processando dados...</div>

Â  Â  <div id="result-area" style="display:none">
Â  Â  Â  Â  <div class="summary-row" id="summary-row"></div>
Â  Â  Â  Â  
Â  Â  Â  Â  <div class="filter-tabs">
Â  Â  Â  Â  Â  Â  <button class="tab-btn active" onclick="setFilter('all', this)">Todas</button>
Â  Â  Â  Â  Â  Â  <button class="tab-btn" onclick="setFilter('added', this)">Novas</button>
Â  Â  Â  Â  Â  Â  <button class="tab-btn" onclick="setFilter('removed', this)">Removidas</button>
Â  Â  Â  Â  Â  Â  <button class="tab-btn" onclick="setFilter('changed', this)">Modificadas</button>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="table-wrap">
Â  Â  Â  Â  Â  Â  <table>
Â  Â  Â  Â  Â  Â  Â  Â  <thead id="thead"></thead>
Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="tbody"></tbody>
Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  </div>
Â  Â  </div>
</div>

<script>
Â  Â  const state = {
Â  Â  Â  Â  wbA: null, wbB: null,
Â  Â  Â  Â  results: [],
Â  Â  Â  Â  filter: 'all',
Â  Â  Â  Â  allCols: [],
Â  Â  Â  Â  watchCols: [],
Â  Â  Â  Â  keyCol: 'NOTA'
Â  Â  };

Â  Â  function handleFile(e, id) {
Â  Â  Â  Â  const file = e.target.files[0];
Â  Â  Â  Â  if (file) processFile(file, id);
Â  Â  }

Â  Â  function handleDrop(e, id) {
Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  const file = e.dataTransfer.files[0];
Â  Â  Â  Â  if (file) processFile(file, id);
Â  Â  }

Â  Â  function processFile(file, id) {
Â  Â  Â  Â  const reader = new FileReader();
Â  Â  Â  Â  reader.onload = (e) => {
Â  Â  Â  Â  Â  Â  const data = new Uint8Array(e.target.result);
Â  Â  Â  Â  Â  Â  const wb = XLSX.read(data, { type: 'array' });
Â  Â  Â  Â  Â  Â  if (id === 'a') state.wbA = wb; else state.wbB = wb;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  document.getElementById(`name-${id}`).textContent = file.name;
Â  Â  Â  Â  Â  Â  document.getElementById(`card-${id}`).classList.add('loaded');
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  const select = document.getElementById(`sheet-${id}`);
Â  Â  Â  Â  Â  Â  select.innerHTML = wb.SheetNames.map(s => `<option value="${s}">${s}</option>`).join('');
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  checkReady();
Â  Â  Â  Â  };
Â  Â  Â  Â  reader.readAsArrayBuffer(file);
Â  Â  }

Â  Â  function checkReady() {
Â  Â  Â  Â  if (state.wbA && state.wbB) {
Â  Â  Â  Â  Â  Â  document.getElementById('btn-compare').disabled = false;
Â  Â  Â  Â  Â  Â  preloadCols();
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function getSheetData(wb, sheetName) {
Â  Â  Â  Â  const ws = wb.Sheets[sheetName];
Â  Â  Â  Â  const raw = XLSX.utils.sheet_to_json(ws, { header: 1, defval: '' });
Â  Â  Â  Â  
Â  Â  Â  Â  // Busca inteligente de cabeÃ§alho
Â  Â  Â  Â  let headerIdx = 0;
Â  Â  Â  Â  for (let i = 0; i < Math.min(10, raw.length); i++) {
Â  Â  Â  Â  Â  Â  if (raw[i].some(c => String(c).toUpperCase().includes('NOTA') || String(c).toUpperCase().includes('PEP'))) {
Â  Â  Â  Â  Â  Â  Â  Â  headerIdx = i;
Â  Â  Â  Â  Â  Â  Â  Â  break;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  const headers = raw[headerIdx].map(h => String(h || '').trim());
Â  Â  Â  Â  const dataRows = raw.slice(headerIdx + 1).filter(r => r.some(c => c !== ''));
Â  Â  Â  Â  return { headers, rows: dataRows };
Â  Â  }

Â  Â  function preloadCols() {
Â  Â  Â  Â  const { headers } = getSheetData(state.wbB, document.getElementById('sheet-b').value);
Â  Â  Â  Â  state.allCols = headers.filter(h => h);
Â  Â  Â  Â  
Â  Â  Â  Â  const keySel = document.getElementById('key-col');
Â  Â  Â  Â  keySel.innerHTML = state.allCols.map(h => `<option value="${h}" ${h === 'NOTA' ? 'selected' : ''}>${h}</option>`).join('');
Â  Â  Â  Â  
Â  Â  Â  Â  const defaults = ['STATUS DA OBRA', 'OBS STATUS', 'ENCARREGADO', 'SUPERVISOR', 'MUNICIPIO'];
Â  Â  Â  Â  state.watchCols = state.allCols.filter(c => defaults.includes(c.toUpperCase()) || defaults.some(d => c.toUpperCase().includes(d)));
Â  Â  Â  Â  
Â  Â  Â  Â  renderChips();
Â  Â  Â  Â  document.getElementById('col-section').style.display = 'block';
Â  Â  }

Â  Â  function renderChips() {
Â  Â  Â  Â  const container = document.getElementById('col-chips');
Â  Â  Â  Â  container.innerHTML = state.allCols.map(c => `
Â  Â  Â  Â  Â  Â  <div class="chip ${state.watchCols.includes(c) ? 'active' : ''}" onclick="toggleCol('${c}')">${c}</div>
Â  Â  Â  Â  `).join('');
Â  Â  }

Â  Â  function toggleCol(col) {
Â  Â  Â  Â  const idx = state.watchCols.indexOf(col);
Â  Â  Â  Â  if (idx > -1) state.watchCols.splice(idx, 1);
Â  Â  Â  Â  else state.watchCols.push(col);
Â  Â  Â  Â  renderChips();
Â  Â  }

Â  Â  function compare() {
Â  Â  Â  Â  document.getElementById('loading').style.display = 'block';
Â  Â  Â  Â  document.getElementById('result-area').style.display = 'none';

Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  const keyCol = document.getElementById('key-col').value;
Â  Â  Â  Â  Â  Â  state.keyCol = keyCol;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  const dataA = getSheetData(state.wbA, document.getElementById('sheet-a').value);
Â  Â  Â  Â  Â  Â  const dataB = getSheetData(state.wbB, document.getElementById('sheet-b').value);

Â  Â  Â  Â  Â  Â  const keyIdxA = dataA.headers.indexOf(keyCol);
Â  Â  Â  Â  Â  Â  const keyIdxB = dataB.headers.indexOf(keyCol);

Â  Â  Â  Â  Â  Â  const mapA = new Map(dataA.rows.map(r => [String(r[keyIdxA] || '').trim(), r]));
Â  Â  Â  Â  Â  Â  const mapB = new Map(dataB.rows.map(r => [String(r[keyIdxB] || '').trim(), r]));

Â  Â  Â  Â  Â  Â  const results = [];
Â  Â  Â  Â  Â  Â  const cols = state.watchCols;

Â  Â  Â  Â  Â  Â  // Novas e Alteradas
Â  Â  Â  Â  Â  Â  mapB.forEach((rowB, key) => {
Â  Â  Â  Â  Â  Â  Â  Â  if (!mapA.has(key)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  results.push({ type: 'added', key, data: rowB, headers: dataB.headers });
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const rowA = mapA.get(key);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const diffs = {};
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let hasDiff = false;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  cols.forEach(col => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const idxA = dataA.headers.indexOf(col);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const idxB = dataB.headers.indexOf(col);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const valA = String(rowA[idxA] || '').trim();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const valB = String(rowB[idxB] || '').trim();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (valA !== valB) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  diffs[col] = { old: valA, new: valB };
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  hasDiff = true;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  diffs[col] = { same: valB };
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (hasDiff) results.push({ type: 'changed', key, diffs });
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  // Removidas
Â  Â  Â  Â  Â  Â  mapA.forEach((rowA, key) => {
Â  Â  Â  Â  Â  Â  Â  Â  if (!mapB.has(key)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  results.push({ type: 'removed', key, data: rowA, headers: dataA.headers });
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  state.results = results;
Â  Â  Â  Â  Â  Â  renderSummary();
Â  Â  Â  Â  Â  Â  renderTable();
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  document.getElementById('loading').style.display = 'none';
Â  Â  Â  Â  Â  Â  document.getElementById('result-area').style.display = 'block';
Â  Â  Â  Â  }, 100);
Â  Â  }

Â  Â  function renderSummary() {
Â  Â  Â  Â  const counts = {
Â  Â  Â  Â  Â  Â  total: state.results.length,
Â  Â  Â  Â  Â  Â  added: state.results.filter(r => r.type === 'added').length,
Â  Â  Â  Â  Â  Â  removed: state.results.filter(r => r.type === 'removed').length,
Â  Â  Â  Â  Â  Â  changed: state.results.filter(r => r.type === 'changed').length
Â  Â  Â  Â  };

Â  Â  Â  Â  document.getElementById('summary-row').innerHTML = `
Â  Â  Â  Â  Â  Â  <div class="stat-card"><div class="stat-val" style="color:var(--text)">${counts.total}</div><div class="stat-label">Total de Alertas</div></div>
Â  Â  Â  Â  Â  Â  <div class="stat-card"><div class="stat-val" style="color:var(--accent2)">${counts.added}</div><div class="stat-label">Novas Obras</div></div>
Â  Â  Â  Â  Â  Â  <div class="stat-card"><div class="stat-val" style="color:var(--danger)">${counts.removed}</div><div class="stat-label">Removidas</div></div>
Â  Â  Â  Â  Â  Â  <div class="stat-card"><div class="stat-val" style="color:var(--accent)">${counts.changed}</div><div class="stat-label">AlteraÃ§Ãµes</div></div>
Â  Â  Â  Â  `;
Â  Â  }

Â  Â  function setFilter(f, btn) {
Â  Â  Â  Â  state.filter = f;
Â  Â  Â  Â  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
Â  Â  Â  Â  btn.classList.add('active');
Â  Â  Â  Â  renderTable();
Â  Â  }

Â  Â  function renderTable() {
Â  Â  Â  Â  const tbody = document.getElementById('tbody');
Â  Â  Â  Â  const thead = document.getElementById('thead');
Â  Â  Â  Â  const filtered = state.filter === 'all' ? state.results : state.results.filter(r => r.type === state.filter);

Â  Â  Â  Â  thead.innerHTML = `<tr><th>Status</th><th>${state.keyCol}</th>${state.watchCols.map(c => `<th>${c}</th>`).join('')}</tr>`;

Â  Â  Â  Â  tbody.innerHTML = filtered.map(r => {
Â  Â  Â  Â  Â  Â  let cells = '';
Â  Â  Â  Â  Â  Â  if (r.type === 'changed') {
Â  Â  Â  Â  Â  Â  Â  Â  cells = state.watchCols.map(c => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const d = r.diffs[c];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return d.old !== undefined 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ? `<td><span class="old-val">${d.old || '(vazio)'}</span><span class="new-val">${d.new || '(vazio)'}</span></td>`
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  : `<td>${d.same}</td>`;
Â  Â  Â  Â  Â  Â  Â  Â  }).join('');
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  cells = state.watchCols.map(c => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const idx = r.headers.indexOf(c);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return `<td>${r.data[idx] || ''}</td>`;
Â  Â  Â  Â  Â  Â  Â  Â  }).join('');
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const badge = `<span class="badge badge-${r.type}">${r.type === 'added' ? 'Nova' : r.type === 'removed' ? 'Sumiu' : 'Muda'}</span>`;
Â  Â  Â  Â  Â  Â  return `<tr class="row-${r.type}"><td>${badge}</td><td style="font-family: 'DM Mono'"><b>${r.key}</b></td>${cells}</tr>`;
Â  Â  Â  Â  }).join('');
Â  Â  }
</script>

</body>
</html>